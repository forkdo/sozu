
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
        <link rel="next" href="../getting_started/">
      
      
        
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>Overview - Sozu Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.618322db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#sozu-tutorial" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Sozu Documentation" class="md-header__button md-logo" aria-label="Sozu Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Sozu Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Overview
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/forkdo/sozu.git" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    forkdo/sozu
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Sozu Documentation" class="md-nav__button md-logo" aria-label="Sozu Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Sozu Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/forkdo/sozu.git" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    forkdo/sozu
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" checked>
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    English Documentation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    English Documentation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      
        Introduction
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-rust-environment-setup" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Rust Environment Setup
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-sozu-installation" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Sozu Installation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Sozu Installation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-install-via-cargo-install" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.1 Install via cargo install
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-build-from-source" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2 Build from Source
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-how-to-use-sozu" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. How to Use Sozu
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. How to Use Sozu">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-running-sozu" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.1 Running Sozu
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-running-with-docker" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.2 Running with Docker
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-systemd-integration" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.3 Systemd Integration
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-sozu-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Sozu Configuration
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Sozu Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-configuration-file-configtoml-structure-overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.1 Configuration File (config.toml) Structure Overview
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-global-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.2 Global Parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-listeners" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.3 Listeners
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting_started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../how_to_use/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    How to use
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configure_cli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CLI Configuration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli_configuration_example/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CLI Configuration Example
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Architecture
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../design_motivation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Design Motivation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../benchmark/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Benchmark
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../debugging_strategies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Debugging Strategies
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lexicon/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lexicon
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lifetime_of_a_session/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lifetime of a session
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../recipes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Recipes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tools_libraries/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tools and Libraries
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../why_you_should_use/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Why you should use Sozu
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Main README
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Chinese Documentation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Chinese Documentation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../overview_zh/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    概述
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting_started_zh/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    入门
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../how_to_use_zh/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    如何使用
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configure_cli_zh/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CLI 配置
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli_configuration_example_zh/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CLI 配置示例
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture_zh/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    架构
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../design_motivation_zh/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    设计动机
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../benchmark_zh/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    基准测试
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../debugging_strategies_zh/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    调试策略
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lexicon_zh/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    词汇表
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lifetime_of_a_session_zh/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    会话生命周期
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../recipes_zh/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    配方
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tools_libraries_zh/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    工具和库
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../why_you_should_use_zh/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    为何使用 Sozu
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../README_zh/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    主 README
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      
        Introduction
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-rust-environment-setup" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Rust Environment Setup
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-sozu-installation" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Sozu Installation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Sozu Installation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-install-via-cargo-install" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.1 Install via cargo install
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-build-from-source" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2 Build from Source
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-how-to-use-sozu" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. How to Use Sozu
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. How to Use Sozu">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-running-sozu" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.1 Running Sozu
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-running-with-docker" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.2 Running with Docker
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-systemd-integration" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.3 Systemd Integration
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-sozu-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Sozu Configuration
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Sozu Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-configuration-file-configtoml-structure-overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.1 Configuration File (config.toml) Structure Overview
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-global-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.2 Global Parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-listeners" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.3 Listeners
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="sozu-tutorial">Sozu Tutorial</h1>
<h2 id="introduction">Introduction</h2>
<p>Sozu is a fast, reliable, and programmable HTTP and TCP reverse proxy written in Rust. It supports advanced routing, load balancing, TLS termination, and dynamic configuration.</p>
<h2 id="1-rust-environment-setup">1. Rust Environment Setup</h2>
<p>Before installing Sozu, ensure you have the latest stable version of Rust installed on your system. We recommend using <code>rustup</code> for installation:</p>
<ol>
<li>
<p><strong>Install <code>rustup</code></strong>: Visit the <a href="https://rustup.rs">official rustup website</a> or run the following command in your terminal:</p>
<p><code>bash
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh</code></p>
</li>
<li>
<p><strong>Configure Environment</strong>: Follow the installer's instructions, which typically involve running <code>source $HOME/.cargo/env</code> to add <code>cargo</code> (Rust's package manager) to your PATH.</p>
</li>
<li>
<p><strong>Verify Installation</strong>: Run <code>rustc --version</code> and <code>cargo --version</code> to verify that Rust is installed successfully.</p>
</li>
</ol>
<h2 id="2-sozu-installation">2. Sozu Installation</h2>
<p>You can choose to install Sozu from crates.io via <code>cargo install</code> or build it from the source code.</p>
<h3 id="21-install-via-cargo-install">2.1 Install via <code>cargo install</code></h3>
<p>Sozu is published on <a href="https://crates.io/">crates.io</a>. Installation is straightforward:</p>
<pre><code class="language-bash">car go install sozu
</code></pre>
<p>After installation, the <code>sozu</code> executable will be available in your <code>~/.cargo/bin</code> directory.</p>
<h3 id="22-build-from-source">2.2 Build from Source</h3>
<p>If you want to build Sozu from the source code (for example, for development or to use the latest version), follow these steps:</p>
<ol>
<li>
<p><strong>Clone the Repository</strong>: If you haven't already, clone the Sozu repository:</p>
<p><code>bash
git clone https://github.com/sozu-proxy/sozu.git
cd sozu</code></p>
</li>
<li>
<p><strong>Build</strong>: Navigate to the <code>bin</code> directory and use the <code>cargo build</code> command. For a production build, be sure to use the <code>--release</code> flag to enable optimizations:</p>
<p><code>bash
cd bin
cargo build --release --locked</code></p>
<ul>
<li>The <code>--release</code> flag tells Cargo to enable compiler optimizations, generating a more performant binary. Use this only for production builds.</li>
<li>The <code>--locked</code> flag forces Cargo to adhere to the dependency versions specified in <code>Cargo.lock</code>, preventing dependency breakage.</li>
</ul>
</li>
</ol>
<p>The executable will be located at <code>target/release/sozu</code> after the build is complete.</p>
<h2 id="3-how-to-use-sozu">3. How to Use Sozu</h2>
<p>Sozu can run as a standalone process or be integrated into a Docker container or Systemd service.</p>
<h3 id="31-running-sozu">3.1 Running Sozu</h3>
<ul>
<li>
<p><strong>If installed via <code>cargo install</code></strong>: The <code>sozu</code> command should already be in your <code>$PATH</code>.</p>
<p><code>bash
sozu start -c &lt;path/to/your/config.toml&gt;</code></p>
</li>
<li>
<p><strong>If built from source</strong>: The executable is in the <code>target/release</code> directory.</p>
<p><code>bash
./target/release/sozu start -c &lt;path/to/your/config.toml&gt;</code></p>
</li>
</ul>
<p>You can edit the reverse proxy's configuration in the <code>config.toml</code> file to declare new clusters, frontends, and backends.</p>
<p><strong>Tip</strong>: You can use the <code>sozu</code> binary as a CLI to interact with the reverse proxy. See the <a href="https://github.com/sozu-proxy/sozu/blob/main/doc/configure_cli.md">command-line documentation</a> for more information.</p>
<h3 id="32-running-with-docker">3.2 Running with Docker</h3>
<p>The Sozu repository provides a multi-stage <code>Dockerfile</code> based on <code>alpine:edge</code>.</p>
<ol>
<li>
<p><strong>Build the Docker Image</strong>:</p>
<p><code>bash
docker build -t sozu .</code></p>
<p>You can also build an image for a specific Alpine version:</p>
<p><code>bash
docker build --build-arg ALPINE_VERSION=3.14 -t sozu:main-alpine-3.14 .</code></p>
</li>
<li>
<p><strong>Run the Docker Container</strong>:</p>
<p><code>bash
docker run \
  --ulimit nofile=262144:262144 \
  --name sozu-proxy \
  -v /run/sozu:/run/sozu \
  -v /path/to/your/config.toml:/etc/sozu/config.toml \
  -v /my/state/:/var/lib/sozu \
  -p 8080:80 \
  -p 8443:443 \
  sozu start -c /etc/sozu/config.toml</code></p>
<ul>
<li><code>-v /path/to/your/config.toml:/etc/sozu/config.toml</code>: Mounts your custom <code>config.toml</code> file into the container.</li>
<li><code>-v /my/state/:/var/lib/sozu</code>: Mounts your initial configuration state JSON file if you have one.</li>
</ul>
</li>
</ol>
<h3 id="33-systemd-integration">3.3 Systemd Integration</h3>
<p>The Sozu repository provides Systemd unit files for easy integration as a service.</p>
<ol>
<li>
<p><strong>Copy the Unit File</strong>: Copy <code>sozu/os-build/systemd/sozu.service</code> to the <code>/etc/systemd/system/</code> directory:</p>
<p><code>bash
sudo cp sozu/os-build/systemd/sozu.service /etc/systemd/system/</code></p>
</li>
<li>
<p><strong>Reload Systemd</strong>:</p>
<p><code>bash
sudo systemctl daemon-reload</code></p>
</li>
<li>
<p><strong>Start the Service</strong>:</p>
<p><code>bash
sudo systemctl start sozu.service</code></p>
</li>
<li>
<p><strong>Enable on Boot</strong>:</p>
<p><code>bash
sudo systemctl enable sozu.service</code></p>
</li>
</ol>
<h2 id="4-sozu-configuration">4. Sozu Configuration</h2>
<p>Sozu's core configuration is managed through the <code>config.toml</code> file. It consists of three main sections: <code>global</code> parameters, protocol definitions (like <code>https</code>, <code>http</code>, <code>tcp</code>), and the <code>clusters</code> section.</p>
<h3 id="41-configuration-file-configtoml-structure-overview">4.1 Configuration File (<code>config.toml</code>) Structure Overview</h3>
<p>Here is an example of a Sozu configuration file:</p>
<pre><code class="language-toml"># Global parameters
command_socket = &quot;./command_folder/sock&quot;
saved_state = &quot;./state.json&quot;
log_level = &quot;info&quot;
log_target = &quot;stdout&quot;
worker_count = 2
handle_process_affinity = false
max_connections = 500
buffer_size = 16384
activate_listeners = true

# Listener configuration
[[listeners]]
protocol = &quot;http&quot;
address = &quot;0.0.0.0:8080&quot;
# public_address = &quot;1.2.3.4:80&quot; # For logs and forwarding headers
# expect_proxy = false # Expect PROXY protocol header

# HTTPS listener example
[[listeners]]
protocol = &quot;https&quot;
address = &quot;0.0.0.0:8443&quot;
certificate = &quot;/path/to/certificate.pem&quot;
key = &quot;/path/to/key.pem&quot;
certificate_chain = &quot;/path/to/certificate_chain.pem&quot;
# tls_versions = [&quot;TLS_V12&quot;, &quot;TLS_V13&quot;]
# answer_404 = &quot;/path/to/my-404-answer.http&quot; # Custom error page

# Cluster configuration
[clusters]
[clusters.MyWebsiteCluster]
protocol = &quot;http&quot; # https proxy also uses http protocol
# load_balancing_policy=&quot;roundrobin&quot; # Load balancing policy: &quot;roundrobin&quot; (default) or &quot;random&quot;
# https_redirect = true # Force redirect of http traffic to https
# sticky_session = true # Optional, enable sticky sessions

frontends = [
  { address = &quot;0.0.0.0:8080&quot;, hostname = &quot;your_domain.com&quot; },
  # For HTTPS frontends, certificate and key are also required
  { address = &quot;0.0.0.0:8443&quot;, hostname = &quot;your_domain.com&quot;, certificate = &quot;/path/to/certificate.pem&quot;, key = &quot;/path/to/key.pem&quot;, certificate_chain = &quot;/path/to/certificate_chain.pem&quot; }
]
backends  = [
  { address = &quot;127.0.0.1:8000&quot; }, # Backend server address
  { address = &quot;127.0.0.1:8001&quot; }
]

# Metrics configuration
[metrics]
address = &quot;127.0.0.1:8125&quot;
# tagged_metrics = false
# prefix = &quot;sozu&quot;
</code></pre>
<h3 id="42-global-parameters">4.2 Global Parameters</h3>
<p>Global parameters are set in the <code>[global]</code> section and affect both the main and worker processes:</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Possible Values</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>saved_state</code></td>
<td>Path from which Sozu attempts to load state on startup</td>
<td></td>
</tr>
<tr>
<td><code>log_level</code></td>
<td>Logging level</td>
<td><code>debug</code>, <code>trace</code>, <code>error</code>, <code>warn</code>, <code>info</code></td>
</tr>
<tr>
<td><code>log_target</code></td>
<td>Logging output destination</td>
<td><code>stdout</code>, <code>tcp</code>, or <code>udp</code> address</td>
</tr>
<tr>
<td><code>access_logs_target</code></td>
<td>Access log output destination (if activated)</td>
<td><code>stdout</code>, <code>tcp</code>, or <code>udp</code> address</td>
</tr>
<tr>
<td><code>command_socket</code></td>
<td>Path to the Unix command socket</td>
<td></td>
</tr>
<tr>
<td><code>worker_count</code></td>
<td>Number of worker processes</td>
<td></td>
</tr>
<tr>
<td><code>handle_process_affinity</code></td>
<td>Bind worker processes to CPU cores</td>
<td><code>true</code>, <code>false</code></td>
</tr>
<tr>
<td><code>max_connections</code></td>
<td>Maximum number of concurrent connections</td>
<td></td>
</tr>
<tr>
<td><code>buffer_size</code></td>
<td>Request buffer size used by worker processes (in bytes)</td>
<td></td>
</tr>
<tr>
<td><code>activate_listeners</code></td>
<td>Automatically start listeners</td>
<td><code>true</code>, <code>false</code></td>
</tr>
<tr>
<td><code>front_timeout</code></td>
<td>Maximum inactivity time for frontend sockets</td>
<td></td>
</tr>
<tr>
<td><code>connect_timeout</code></td>
<td>Maximum inactivity time for connection requests</td>
<td></td>
</tr>
<tr>
<td><code>request_timeout</code></td>
<td>Maximum inactivity time for requests</td>
<td></td>
</tr>
<tr>
<td><code>zombie_check_interval</code></td>
<td>Interval for checking zombie sessions</td>
<td></td>
</tr>
<tr>
<td><code>pid_file_path</code></td>
<td>Path to the file where the PID is stored</td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="43-listeners">4.3 Listeners</h3>
<p>The <code>[[listeners]]</code> section defines a set of listening sockets that accept client connections. You can define any number of listeners.</p>
<ul>
<li>
<p><strong>Common Parameters</strong>:
    <code>toml
    [[listeners]]
    protocol = "http" # or "https", "tcp"
    address = "0.0.0.0:8080"
    # public_address = "1.2.3.4:80" # Optional, for logs and forwarding headers
    # expect_proxy = true # Optional, configure client socket to receive PROXY protocol header</code></p>
</li>
<li>
<p><strong>HTTP and HTTPS Listener Specific Options (Custom Error Pages)</strong>:
    You can define custom responses for HTTP and HTTPS listeners, such as 404 Not Found or 503 Service Unavailable. These responses can be plain text files containing HTML and some template variables (e.g., <code>%REQUEST_ID%</code>).</p>
<p>```toml</p>
<h1 id="send-a-404-response-when-sozu-doesnt-know-the-requested-domain-or-path">Send a 404 response when Sozu doesn't know the requested domain or path</h1>
<p>answer_404 = "/path/to/my-404-answer.http"</p>
<h1 id="send-a-503-response-when-no-backend-servers-are-available">Send a 503 response when no backend servers are available</h1>
<p>answer_503 = "/path/to/my-503-answer.http"
```</p>
</li>
<li>
<p><strong>HTTPS Listener Specific Options</strong>:
    <code>toml
    # Supported TLS versions. Possible values: "SSL_V2", "SSL_V3", "TLS_V12", "TLS_V13". Defaults to "TLS_V12" and "TLS_V13".
    tls_versions = ["TLS_V12", "TLS_V13"]
    # Defines the name of the sticky session cookie if the cluster has sticky_session activated. Defaults to "SOZUBALANCEID".
    sticky_name = "SOZUBALANCEID"</code></p>
<p>Rustls-based HTTPS listener specific options:
<code>toml
cipher_list = [
    # TLS 1.3 cipher suites
    "TLS13_AES_256_GCM_SHA384",
    # ... other cipher suites
]</code></p>
</li>
</ul>
<h3 id="44-clusters">4.4 Clusters</h3>
<p>Declare your list of clusters in the <code>[clusters]</code> section:</p>
<pre><code class="language-toml">[clusters]
[clusters.MyWebsiteCluster]
protocol = &quot;http&quot; # or &quot;tcp&quot;. HTTPS proxy also uses http protocol
# load_balancing_policy=&quot;roundrobin&quot; # Load balancing policy: &quot;roundrobin&quot; (default) or &quot;random&quot;
# https_redirect = true # Force redirect of http traffic to https
# sticky_session = true # Optional, enable sticky sessions

frontends = [
  { address = &quot;0.0.0.0:8080&quot;, hostname = &quot;your_domain.com&quot; },
  # For HTTPS frontends, certificate and key are also required
  { address = &quot;0.0.0.0:8443&quot;, hostname = &quot;your_domain.com&quot;, certificate = &quot;/path/to/certificate.pem&quot;, key = &quot;/path/to/key.pem&quot;, certificate_chain = &quot;/path/to/certificate_chain.pem&quot; }
]
backs  = [
  { address = &quot;127.0.0.1:8000&quot; }, # Backend server address
  { address = &quot;127.0.0.1:8001&quot; }
]
</code></pre>
<h3 id="45-metrics">4.5 Metrics</h3>
<p>Sozu reports its status to other network components via a UDP socket and implements the <code>statsd</code> protocol.</p>
<p>Configuration:</p>
<pre><code class="language-toml">[metrics]
address = &quot;127.0.0.1:8125&quot; # Address and port of the statsd service
# tagged_metrics = false # Use InfluxDB's statsd protocol to add tags
# prefix = &quot;sozu&quot; # Prefix for metric keys
</code></pre>
<h3 id="46-proxy-protocol">4.6 PROXY Protocol</h3>
<p>The PROXY protocol is used to pass the client's real IP address and port information through a chain of proxies. Sozu supports PROXY protocol version 2.</p>
<ul>
<li>
<p><strong>Configure Sozu to Expect a PROXY Protocol Header</strong>:
    <code>toml
    [[listeners]]
    address = "0.0.0.0:80"
    expect_proxy = true</code></p>
<p>This makes the client connection receive a PROXY protocol header before any other data is read.</p>
</li>
<li>
<p><strong>Configure Sozu to Send a PROXY Protocol Header to the Backend</strong>:
    ```toml
    [[listeners]]
    address = "0.0.0.0:81"</p>
<p>[clusters]
[clusters.NameOfYourTcpCluster]
send_proxy = true
frontends = [
  { address = "0.0.0.0:81" }
]
```
<strong>Note</strong>: Only applicable to TCP clusters (HTTP and HTTPS proxies will use forwarding headers).</p>
</li>
<li>
<p><strong>Configure Sozu to Forward a PROXY Protocol Header</strong>:
    ```toml
    [[listeners]]
    address = "0.0.0.0:80"
    expect_proxy = true</p>
<p>[clusters]
[clusters.NameOfYourCluster]
send_proxy = true
frontends = [
  { address = "0.0.0.0:80" }
]
```</p>
<p>Sozu will receive the PROXY protocol header from the client connection, validate it, and then forward it to the upstream backend. This allows a proxy chain to work without losing client connection information.
<strong>Note</strong>: Only applicable to TCP clusters.</p>
</li>
</ul>
<h2 id="5-dynamic-backend-management-service-discovery">5. Dynamic Backend Management (Service Discovery)</h2>
<p>In dynamic environments like Docker, the IP addresses of backend services can change frequently. Although <code>config.toml</code> resolves IP addresses at startup, you can use the Sozu command-line tool (CLI) to <strong>dynamically add, update, or remove backends</strong> without restarting Sozu.</p>
<p>This process requires an external mechanism (such as a simple script, a service discovery tool, or a custom program) to:</p>
<ol>
<li><strong>Monitor</strong> your backend services (e.g., by listening to container start/stop events via the Docker API, or querying Docker's built-in DNS service).</li>
<li><strong>Obtain</strong> the current IP address and port of the backend services.</li>
<li><strong>Use the <code>sozu</code> CLI tool</strong> to send commands to the running Sozu instance.</li>
</ol>
<p>Here is an example of using the <code>sozu</code> CLI to manage backends:</p>
<h3 id="51-start-sozu-to-accept-commands">5.1 Start Sozu to Accept Commands</h3>
<p>Ensure that the <code>command_socket</code> is configured correctly in your <code>config.toml</code> so that the CLI tool can connect to the running Sozu instance. For example:</p>
<pre><code class="language-toml">command_socket = &quot;/var/lib/sozu/command.sock&quot;
</code></pre>
<h3 id="52-find-a-docker-containers-ip-address">5.2 Find a Docker Container's IP Address</h3>
<p>Assuming your Docker network is named <code>my-network</code> and your backend service is named <code>my-backend-app</code>, you can use the <code>docker inspect</code> command to get its IP address.</p>
<pre><code class="language-bash"># Get the IP address of a single running container
docker inspect -f '{{range .NetworkSettings.Networks}}{{.IPAddress}}{{end}}' my-backend-app

# Assuming your backend service is exposed on port 8080
export BACKEND_IP=$(docker inspect -f '{{range .NetworkSettings.Networks}}{{.IPAddress}}{{end}}' my-backend-app)
export BACKEND_PORT=8080
export BACKEND_ADDRESS=&quot;${BACKEND_IP}:${BACKEND_PORT}&quot;
</code></pre>
<p>In a <code>docker-compose</code> environment, if services are under the same <code>user-defined bridge network</code>, the service name can often be resolved directly as a hostname. However, if Sozu resolves IPs at startup, you still need to get the IP first.</p>
<h3 id="53-dynamically-add-a-backend">5.3 Dynamically Add a Backend</h3>
<p>Use the <code>sozu backend add</code> command to add a new backend to a specified cluster.</p>
<pre><code class="language-bash"># Assuming your Sozu config path is /etc/sozu/config.toml
# and the command_socket is set in that file
# Assuming your cluster ID is 'komo'
CONFIG_PATH=&quot;/etc/sozu/config.toml&quot;
CLUSTER_ID=&quot;komo&quot;
NEW_BACKEND_ID=&quot;backend-1&quot; # Provide a unique ID for the new backend
NEW_BACKEND_ADDRESS=&quot;172.17.0.5:9120&quot; # Replace with your backend's actual IP:port

sozu --config &quot;${CONFIG_PATH}&quot; backend add --id &quot;${CLUSTER_ID}&quot; --backend-id &quot;${NEW_BACKEND_ID}&quot; --address &quot;${NEW_BACKEND_ADDRESS}&quot;
</code></pre>
<ul>
<li><code>--config</code>: Specifies the path to the Sozu configuration file, which should contain the path to the <code>command_socket</code>.</li>
<li><code>backend add</code>: Indicates the action to add a backend.</li>
<li><code>--id</code>: Specifies the cluster ID to add the backend to.</li>
<li><code>--backend-id</code>: Provides a unique identifier for this backend instance.</li>
<li><code>--address</code>: Specifies the IP address and port of the backend server.</li>
</ul>
<h3 id="54-dynamically-remove-a-backend">5.4 Dynamically Remove a Backend</h3>
<p>Use the <code>sozu backend remove</code> command to remove a backend from a specified cluster.</p>
<pre><code class="language-bash"># Assuming your Sozu config path is /etc/sozu/config.toml
CONFIG_PATH=&quot;/etc/sozu/config.toml&quot;
CLUSTER_ID=&quot;komo&quot;
OLD_BACKEND_ID=&quot;backend-1&quot; # The ID of the backend to remove
OLD_BACKEND_ADDRESS=&quot;172.17.0.5:9120&quot; # Replace with the actual IP:port of the backend to remove

sozu --config &quot;${CONFIG_PATH}&quot; backend remove --id &quot;${CLUSTER_ID}&quot; --backend-id &quot;${OLD_BACKEND_ID}&quot; --address &quot;${OLD_BACKEND_ADDRESS}&quot;
</code></pre>
<ul>
<li><code>--config</code>: Specifies the path to the Sozu configuration file.</li>
<li><code>backend remove</code>: Indicates the action to remove a backend.</li>
<li><code>--id</code>: Specifies the cluster ID to remove the backend from.</li>
<li><code>--backend-id</code>: The ID of the backend to remove.</li>
<li><code>--address</code>: The IP address and port of the backend server to remove.</li>
</ul>
<h3 id="55-check-sozu-worker-status">5.5 Check Sōzu Worker Status</h3>
<p>You can use the <code>sozu status</code> command to check the running status of the Sōzu workers.</p>
<pre><code class="language-bash"># Assuming your Sozu config path is /etc/sozu/config.toml
CONFIG_PATH=&quot;/etc/sozu/config.toml&quot;
sozu --config &quot;${CONFIG_PATH}&quot; status --json
</code></pre>
<p>This will return the current worker status in JSON format. To see detailed cluster, frontend, and backend configurations, see the next section.</p>
<h3 id="56-automation-script-concept">5.6 Automation Script (Concept)</h3>
<p>To achieve true service discovery, you need to write a continuously running script (e.g., using Python, Bash, or Go) that:</p>
<ol>
<li><strong>Periodically</strong> or by <strong>event-listening</strong> to the Docker API, detects changes in backend containers.</li>
<li><strong>Compares</strong> the list of backends currently in Sozu with the list of backends actually running in Docker.</li>
<li><strong>Executes</strong> <code>sozu backend add</code> or <code>sozu backend remove</code> commands to synchronize the two lists.</li>
</ol>
<p>This script will act as the "control plane" in your service discovery solution.</p>
<h3 id="57-view-dynamically-added-frontends-and-backends">5.7 View Dynamically Added Frontends and Backends</h3>
<p>After dynamically adding a <code>frontend</code> or <code>backend</code> via the command line, you might want to verify that they have been loaded successfully. Sōzu's routing structure is <code>frontend</code> -&gt; <code>cluster</code> -&gt; <code>backend</code>. You can track and view this dynamically added data in two steps:</p>
<ol>
<li>
<p><strong>Find the <code>cluster ID</code> for a <code>frontend</code></strong></p>
<p>Use the <code>sozu frontend list --json</code> command to list all configured frontends. In the returned JSON data, find the <code>frontend</code> you are interested in and note its <code>cluster_id</code>.</p>
<p>```bash</p>
<h1 id="replace-with-your-config-file-path">Replace <path/to/your/config.toml> with your config file path</h1>
<p>sozu --config <path/to/your/config.toml> frontend list --json
```</p>
</li>
<li>
<p><strong>Find the <code>backends</code> for a <code>cluster ID</code></strong></p>
<p>Once you have the <code>cluster ID</code>, use the <code>sozu cluster list --id &lt;CLUSTER_ID&gt;</code> command to view the details of that specific cluster, which includes a list of all its <code>backends</code>.</p>
<p>```bash</p>
<h1 id="replace-and">Replace <path/to/your/config.toml> and <YOUR_CLUSTER_ID></h1>
<p>sozu --config <path/to/your/config.toml> cluster list --id <YOUR_CLUSTER_ID> --json
```</p>
</li>
</ol>
<p>Through this two-step process, you can clearly see the complete mapping from <code>frontend</code> to <code>backend</code> and confirm that your dynamic configuration has been applied.</p>
<p>We hope this tutorial helps you to better understand and use Sozu!</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": [], "search": "../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
    
  </body>
</html>