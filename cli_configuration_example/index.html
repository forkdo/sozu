
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../configure_cli/">
      
      
        <link rel="next" href="../architecture/">
      
      
        
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>CLI Configuration Example - Sozu Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.618322db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#configuring-a-cluster-via-the-sozu-command-line" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Sozu Documentation" class="md-header__button md-logo" aria-label="Sozu Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Sozu Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              CLI Configuration Example
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/forkdo/sozu.git" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    forkdo/sozu
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Sozu Documentation" class="md-nav__button md-logo" aria-label="Sozu Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Sozu Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/forkdo/sozu.git" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    forkdo/sozu
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" checked>
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    English Documentation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    English Documentation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting_started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../how_to_use/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    How to use
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configure_cli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CLI Configuration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    CLI Configuration Example
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    CLI Configuration Example
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#configuring-a-cluster-via-the-sozu-command-line" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuring a Cluster via the Sozu Command Line
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuring a Cluster via the Sozu Command Line">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#original-configtoml-configuration-example" class="md-nav__link">
    <span class="md-ellipsis">
      
        Original config.toml Configuration Example:
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#converting-configtoml-configuration-to-command-line-instructions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Converting config.toml Configuration to Command-Line Instructions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Converting config.toml Configuration to Command-Line Instructions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-add-a-cluster" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Add a Cluster
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-add-frontends" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Add Frontends
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-add-a-backend" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Add a Backend
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#complete-command-line-configuration-flow" class="md-nav__link">
    <span class="md-ellipsis">
      
        Complete Command-Line Configuration Flow
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Complete Command-Line Configuration Flow">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-create-a-cluster" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 1: Create a Cluster
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-add-a-certificate-for-https" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 2: Add a Certificate for HTTPS
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-associate-frontends" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 3: Associate Frontends
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-associate-a-backend" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 4: Associate a Backend
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Architecture
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../design_motivation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Design Motivation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../benchmark/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Benchmark
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../debugging_strategies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Debugging Strategies
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lexicon/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lexicon
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lifetime_of_a_session/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lifetime of a session
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../recipes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Recipes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tools_libraries/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tools and Libraries
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../why_you_should_use/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Why you should use Sozu
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Main README
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Chinese Documentation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Chinese Documentation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../overview_zh/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    概述
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting_started_zh/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    入门
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../how_to_use_zh/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    如何使用
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configure_cli_zh/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CLI 配置
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli_configuration_example_zh/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CLI 配置示例
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture_zh/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    架构
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../design_motivation_zh/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    设计动机
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../benchmark_zh/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    基准测试
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../debugging_strategies_zh/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    调试策略
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lexicon_zh/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    词汇表
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lifetime_of_a_session_zh/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    会话生命周期
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../recipes_zh/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    配方
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tools_libraries_zh/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    工具和库
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../why_you_should_use_zh/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    为何使用 Sozu
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../README_zh/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    主 README
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#configuring-a-cluster-via-the-sozu-command-line" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuring a Cluster via the Sozu Command Line
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuring a Cluster via the Sozu Command Line">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#original-configtoml-configuration-example" class="md-nav__link">
    <span class="md-ellipsis">
      
        Original config.toml Configuration Example:
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#converting-configtoml-configuration-to-command-line-instructions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Converting config.toml Configuration to Command-Line Instructions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Converting config.toml Configuration to Command-Line Instructions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-add-a-cluster" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Add a Cluster
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-add-frontends" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Add Frontends
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-add-a-backend" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Add a Backend
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#complete-command-line-configuration-flow" class="md-nav__link">
    <span class="md-ellipsis">
      
        Complete Command-Line Configuration Flow
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Complete Command-Line Configuration Flow">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-create-a-cluster" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 1: Create a Cluster
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-add-a-certificate-for-https" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 2: Add a Certificate for HTTPS
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-associate-frontends" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 3: Associate Frontends
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-associate-a-backend" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 4: Associate a Backend
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>CLI Configuration Example</h1>

<h3 id="configuring-a-cluster-via-the-sozu-command-line">Configuring a Cluster via the Sozu Command Line</h3>
<p>This document demonstrates how to use the <code>sozu</code> command-line tool to configure clusters, frontends, and backends as an alternative to directly editing the <code>config.toml</code> file.</p>
<p><strong>Important Note:</strong> All <code>sozu</code> commands require the <code>--config &lt;your-config-file&gt;</code> parameter to specify the configuration file. This file contains the path to the command socket that the sozu instance is listening on, allowing the command-line tool to communicate with sozu. In the following examples, we use <code>--config config.toml</code>.</p>
<h4 id="original-configtoml-configuration-example">Original <code>config.toml</code> Configuration Example:</h4>
<pre><code class="language-toml"># A unique identifier for our routing rule.
[clusters.komo]

# The protocol this cluster will handle.
protocol = &quot;http&quot;
load_balancing = &quot;ROUND_ROBIN&quot;

# 'frontends' define which requests this cluster will handle.
# It matches requests coming to the listener at 'address' with the specified 'hostname'.
frontends = [
    { address = &quot;0.0.0.0:80&quot;, hostname = &quot;dash.bdev.cn&quot; },
    { address = &quot;0.0.0.0:443&quot;, hostname = &quot;dash.bdev.cn&quot; }
]

# 'backends' define where to forward the matched requests.
backends = [
    { address = &quot;komodo-core-1:9120&quot; }
]
</code></pre>
<h4 id="converting-configtoml-configuration-to-command-line-instructions">Converting <code>config.toml</code> Configuration to Command-Line Instructions</h4>
<p>The following are the steps to convert the <code>config.toml</code> configuration above into equivalent <code>sozu</code> command-line instructions:</p>
<h5 id="1-add-a-cluster">1. Add a Cluster</h5>
<p>First, create a new cluster named <code>komo</code> and set its load balancing policy. Note that we use the <code>--id</code> and <code>--load-balancing-policy</code> parameters.</p>
<pre><code class="language-bash">sozu --config config.toml cluster add --id komo --load-balancing-policy ROUND_ROBIN
</code></pre>
<p><strong>Explanation:</strong>
*   <code>--config config.toml</code>: Specifies the sozu configuration file.
*   <code>cluster add --id komo</code>: Creates a new cluster with the unique identifier <code>komo</code>.
*   <code>--load-balancing-policy ROUND_ROBIN</code>: Sets the load balancing algorithm to round-robin.</p>
<p><strong>Regarding Protocol (<code>protocol</code>):</strong>
The <code>cluster add</code> command may not directly support setting the protocol. If <code>http</code> is not the default, you may need to use the <code>sozu cluster modify</code> command or check <code>sozu cluster add --help</code> for complete options.</p>
<h5 id="2-add-frontends">2. Add Frontends</h5>
<p>Next, add two frontends for the <code>komo</code> cluster to match incoming requests. Note the structure of the command: the protocol (<code>http</code> or <code>https</code>) comes after <code>frontend</code>, and you must use the <code>id &lt;cluster_id&gt;</code> subcommand at the end to associate it with the cluster.</p>
<pre><code class="language-bash"># Add a frontend to handle HTTP (port 80)
sozu --config config.toml frontend http add --address 0.0.0.0:80 --hostname dash.bdev.cn id komo

# Add a frontend to handle HTTPS (port 443)
sozu --config config.toml frontend https add --address 0.0.0.0:443 --hostname dash.bdev.cn id komo
</code></pre>
<p><strong>Explanation:</strong>
*   <code>frontend http add</code> / <code>frontend https add</code>: Defines a frontend addition operation for the HTTP or HTTPS protocol, respectively.
*   <code>--address ... --hostname ...</code>: Defines the rules for matching traffic.
*   <code>id komo</code>: Associates this frontend rule with the cluster with ID <code>komo</code>.</p>
<h5 id="3-add-a-backend">3. Add a Backend</h5>
<p>Finally, add the backend service address to the <code>komo</code> cluster. Sozu will forward matched requests here. Note that you need to specify the cluster with <code>--id</code> and provide a unique identifier for this backend with <code>--backend-id</code>.</p>
<pre><code class="language-bash">sozu --config config.toml backend add --id komo --backend-id komodo-core-1 --address komodo-core-1:9120
</code></pre>
<p><strong>Explanation:</strong>
*   <code>backend add</code>: Defines a backend addition operation.
*   <code>--id komo</code>: Specifies the target cluster ID to add the backend to.
*   <code>--backend-id komodo-core-1</code>: Sets a unique identifier for this backend within the cluster.
*   <code>--address komodo-core-1:9120</code>: Sets the address and port of the backend server.</p>
<hr />
<h3 id="complete-command-line-configuration-flow">Complete Command-Line Configuration Flow</h3>
<p>The design philosophy of <code>sozu</code> is to <strong>manage listeners, certificates, and routing rules (frontends) separately</strong>. Configuring a complete HTTPS service, as described in a <code>config.toml</code> file, requires a series of steps via the command line.</p>
<p>Assume your certificate and private key files are located at:
*   Certificate: <code>/etc/sozu/certs/certificate.pem</code>
*   Private Key: <code>/etc/sozu/certs/key.pem</code></p>
<p>The following are the complete steps:</p>
<h4 id="step-1-create-a-cluster">Step 1: Create a Cluster</h4>
<p>First, create a new cluster named <code>komo</code> and set its load balancing policy.</p>
<pre><code class="language-bash"># 1. Create the cluster
sozu --config config.toml cluster add --id komo --load-balancing-policy ROUND_ROBIN
</code></pre>
<h4 id="step-2-add-a-certificate-for-https">Step 2: Add a Certificate for HTTPS</h4>
<p>For HTTPS traffic, you must first associate the TLS certificate and private key with the address that will be listening (<code>0.0.0.0:443</code>).</p>
<pre><code class="language-bash"># 2. Add the certificate
sozu --config config.toml certificate add \
  --address 0.0.0.0:443 \
  --certificate /etc/sozu/certs/certificate.pem \
  --certificate-chain /etc/sozu/certs/certificate.pem \
  --key /etc/sozu/certs/key.pem
</code></pre>
<p><strong>Explanation:</strong>
*   <code>certificate add</code>: Defines a certificate addition operation.
*   <code>--address 0.0.0.0:443</code>: Specifies which listening address this certificate is for.
*   <code>--certificate</code>, <code>--certificate-chain</code>, <code>--key</code>: Specify the file paths for the certificate, certificate chain, and private key, respectively. If the certificate and chain are in the same file, you can use the same path for both.</p>
<h4 id="step-3-associate-frontends">Step 3: Associate Frontends</h4>
<p>Now, create frontend rules to tell sozu how to route traffic from ports 80 (HTTP) and 443 (HTTPS) based on the <code>hostname</code>.</p>
<pre><code class="language-bash"># 3. Associate the frontends
sozu --config config.toml frontend http add --address 0.0.0.0:80 --hostname dash.bdev.cn id komo
sozu --config config.toml frontend https add --address 0.0.0.0:443 --hostname dash.bdev.cn id komo
</code></pre>
<p><strong>Explanation:</strong>
*   <code>frontend http add</code> / <code>frontend https add</code>: Defines routing rules for HTTP and HTTPS, respectively.
*   <code>id komo</code>: Routes traffic matching this rule to the cluster with ID <code>komo</code>.</p>
<h4 id="step-4-associate-a-backend">Step 4: Associate a Backend</h4>
<p>Finally, add the backend service address to the <code>komo</code> cluster.</p>
<pre><code class="language-bash"># 4. Associate the backend
sozu --config config.toml backend add --id komo --backend-id komodo-core-1 --address komodo-core-1:9120
</code></pre>
<p><strong>Explanation:</strong>
*   <code>backend add</code>: Defines a backend addition operation.
*   <code>--id komo</code>: Specifies the target cluster to add the backend to.
*   <code>--backend-id ... --address ...</code>: Defines the unique ID and address of the backend.</p>
<hr />
<p>By following these four steps, you have completely reproduced the configuration from the <code>config.toml</code> file using the command line.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": [], "search": "../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
    
  </body>
</html>